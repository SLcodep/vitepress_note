---
title: Tree-Shaking
date: 2025-11-27 17:24:35
permalink: /performance/Tree-Shaking
# titleTag: 
categories:
  - 性能优化
tags:
  - 性能优化
---

:::tip
Tree Shaking 的本质是：在打包阶段，基于ES Module的静态结构，**删除确定不会被使用的代码**，从而减小 bundle 体积。
:::

Tree-Shaking 的原理是基于静态分析。在打包过程中，打包工具会遍历所有的模块，并记录下每个模块的导出和导入关系。然后，通过分析这些关系，找出那些没有被使用的模块和代码。最后，将这些无用代码从打包文件中移除。
Tree-Shaking 的核心思想**是只打包需要的代码**。当一个模块被导入时，打包工具会检查该模块中的所有导出变量和函数。如果这些变量和函数没有被其他模块导入，那么它们就不会被打包到最终的文件中。这样，就可以有效地去除冗余代码，减少文件大小。

## Tree Shaking在Vite和Webpack的区别？

| 特性                  | Vite (Rollup)      | Webpack                                   |
| --------------------- | ------------------ | ----------------------------------------- |
| **底层工具**          | Rollup             | 自有引擎 + Terser                         |
| **Tree Shaking 时机** | 打包阶段直接删除   | 打包阶段标记，压缩阶段删除                |
| **效果**              | 通常更彻底         | 依赖配置和 Terser 优化                    |
| **配置复杂度**        | 简单，默认开启     | 需手动配置 `usedExports` 和 `sideEffects` |
| **模块类型要求**      | 必须是 ES 模块     | 必须是 ES 模块                            |
| **适用场景**          | 中小型项目、库开发 | 大型复杂应用                              |

