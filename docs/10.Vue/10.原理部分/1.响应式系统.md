---
title: vue响应式系统
date: 2025-11-27 17:24:35
permalink: /vue/原理部分
# titleTag: 
categories:
  - Vue
tags:
  - vue
---



> 目标是理解 Vue 的底层逻辑，能解决复杂问题、阅读源码。
>
> **响应式系统**--`Object.defineProperty`实现数据劫持；`Proxy`代理对象，`effect`收集依赖、`track`/`trigger`触发更新
>
> **虚拟 DOM 与 Diff 算法**：虚拟 DOM 的作用，Diff 算法的核心:同层比较、`key`的作用、双端对比策略
>
> 模板编译
>
> **生命周期执行逻辑**：初始化→挂载→更新→卸载
>
> **keep-alive底层原理**


:::tip
参考内容
- [Vue 响应式原理深度解析](https://www.cnblogs.com/ljbguanli/p/19432255)
- [vue官方-深入响应式系统](https://cn.vuejs.org/guide/extras/reactivity-in-depth.html#what-is-reactivity)
- 
:::

## 1.响应式的核心本质：数据劫持 + 依赖收集

**响应式的核心目标**：当数据发生变化时，自动触发依赖该数据的视图更新或逻辑执行。
需要解决两个关键问题：
**1.数据劫持**：如何 “监听” 数据的读写操作?
**2.依赖收集**: 如何记录"哪些视图 / 逻辑依赖了这个数据"?

![响应式](/public/qian/响应式.png)

## 2.Vue2 响应式原理：Object.defineProperty
上面提到主要是针对数据劫持和依赖收集,vue采用defineProperty实现数据劫持-被劫持的书写，会对应一个Dep实例，依赖收集-watcher记录依赖与Dep建立关联。

### Object.defineProperty的问题
**1. 无法监听对象新增 / 删除属性**
`defineProperty`只能劫持已存在的属性，如果给对象新增属性（比如data.user = { name: '张三' }），或删除属性（delete data.name），不会触发getter/setter，导致响应式失效。

**2.无法监听数组的部分操作**
 Vue2 对数组的push、pop、shift、unshift、splice、sort、reverse7 种方法进行了重写，可以触发响应式。但是对一下内容：
 1.直接修改数组索引：`arr[0] = 10`；
 2.直接修改数组长度：`arr.length = 0`。

## 3. Vue3 响应式原理Proxy 
