---
title: 计算机网络基础内容
date: 2025-11-27 17:24:35
permalink: /network/01
# titleTag:
categories:
  - 前端
tags:
  - 前端
---

## 1.七层模型

> 在传输层有 TCP 和 UDP，TCP 更可靠安全，UDP 实时性更好，不稳定
>
> > 应用层：ajax 调用接口 http 请求，域名系统，ssh 协议，webSocket 长连接

![76423011616](../../public/qian/1764230116166.png)

## TCP 三次握手

在建立连接时经过三次握手

> **名词描述**
> 1.seq（sequence number），序列号随机生成的
> 2.ack（acknowledgement number）确认号 ack = seq + 1
> 3.ACK （acknowledgement）确定序列号有效
> 4.SYN（synchronous）发起新连接
> 客户端建立连接，发起请求；服务端验证，通过返回 ack=seq+1；之后客户端在接受到服务端返回的 ack 之后，将 seq+1，ack 告知服务端我收到回应，建立连接。

![76423017442](../../public/qian/1764230174421.png)

## TCP 四次挥手

> 四次挥手可以是客户端发起，也可以是服务端发起

![76423019115](../../public/qian/1764230191154.png)
本图是客户端发起的断开。
1.**客户端发起关闭请求** ,客户端进行断开操作先发送`FIN`包生成客户端的`seq`序列号随后进入`wait1状态` ,这是**第一次挥手**。 
2.**服务端确认请求（第二次挥手）** ,服务端收到 FIN 包表示自己进入了关闭等待状态，然后向客户端使用 ack 验证，验证成功打上 ACK 标记，随后生成服务端的`seq值`发送给客户端，这是第二次挥手，服务端此时还可以发送未完成的数据。
3.**服务端发起关闭请求（第三次挥手）** ,等待服务端所有任务操作完成之后服务端开始进入最后确认状态，向客户端发送`FIN包`,并且验证 ack，使用客户端第一次的`seq + 1`去验证，验证成功打上 ACK 标记，并且生成一个新的序列号 seq 发送给客户端，这是第三次挥手。 
4.**客户端最终确认（第四次挥手）** 客户端收到之后进入超时等待状态`2MSL（1-4分钟）`，经过等到后客户端关闭连接，而服务端收到信息验证完成 ack 成功之后打上`ACk`标记随后将关闭连接。

## DNS

> 什么是 DNS？
> DNS 是域名系统 (Domain Name System) 的缩写，提供的是一种主机名到 IP 地址的转换服务

### DNS 完整的查询过程

**分层缓存 + 逐级查询**
> 浏览器缓存 → 本地 DNS→ 根服务器 → 顶级服务器 → 权威服务器

**第一步**：**浏览器的缓存**中查找对应的 IP 地址；否则下一步
**第二步**：将请求发送给**本地 DNS 服务器**，在本地域名服务器缓存中查询；否则下一步
**第三步**：本地 DNS 服务器向**根域名服务器**发送请求，根域名服务器会返回一个所查询域的顶级域名服务器地址
**第四步**：本地 DNS 服务器向**顶级域名服务器**发送请求
***第五步***：本地 DNS 服务器向**权威域名服务器**发送请求，域名服务器返回对应的结果

## 浏览器请求缓存

> POST 请求时，跨域或者自定义请求头可能会有两个 HTTP 请求，其中 options 是预检，先确保是否是安全的；第二个是 post 请求返回

在发起请求有一步操作是查看是否有缓存
强缓存、协商缓存

## CDN 内容分发

CDN是由分布在多个地理位置的服务器组成的网络，其**目标是通过将内容分发到靠近用户的服务器上**，从而提升内容传输的效率、降低延迟，并提高用户体验。
CDN一般会用来托管Web资源 (包括文本、图片和脚本等)，可供下载的资源(媒体文件、软件、文档等)，应用程序(门户网站) 等 。

![CDN](/qian/CDN.png)

**CDN的加速流程通常包括以下几个步骤：**
**1.域名解析：** 当用户在浏览器中输入网址并按下回车键后，浏览器会向本地DNS服务器发送域名解析，本地DNS服务器会返回CDN的负载均衡器的地址。
**2.负载均衡**：浏览器根据负载均衡器的IP地址，向CDN负载均衡器发送请求。载均衡器的作用是选择一个最合适的CDN节点服务器来响应用户的请求。
**3.缓存判断**：CDN节点服务器收到用户的请求后，会先判断请求资源是否缓存在其本地服务器上。如果有，则直接返回缓的资源，这样可以大大提高响应速度和节省带宽消耗。如果没有缓存的资源，则进入下一步。
**4.源服务器回源**：当节点服务器没有缓存所需的资源时，会向源服务器发送请求，获取资源的原始本。源服务器可以是网站的服务器、视频流媒体的视频源服务器等，根据不同的业务需求而定。
**5.传输加速**：源服务器将请求资源发送给节点服务器后，节点服务器会将资源按照缓存策略进行存储，并将资源回传给用户的浏览器。由于CDN节点服务器通常位于离用户更近的一方，因此传输时间较短，用户可以更快地获取请求的资源。
**6.动态内容回源**：对于一些动态生成的内容或需要实时更新的资源（如用户个人信息、实时天气数据等），CDN节点服务器需要及时回源更新这些内容，以保证数据的实时性和准确性。

### 使用场景
**1.加载公共库和框架**
```js
//CDN jQuery库
<script src="https://cdn.jsdelivr/npm/jquery@3.60/dist/jquery.min.js"></script>
```
**2.加载图片CDN**
我们打开稀土掘金网站，随便打开一篇文章，我们可以很多图片都是从 CDN 服务器上请求来的，这极大的提高了图片的响应速度。针对上线项目，如果涉及跨区域访问，使用cdn管理一些静态资源是一个很好的选择。


## SSE 与 websocket

### SSE

在正常的 hhtp 请求中，都是客户端向服务器发起一次请求，服务器将数据返回给客户端。而 SSE 是客户端向服务器发起一次请求后，服务器可以多次发送数据给客户端。
![SSE](/qian/SSE.png)

---

### websocket

websocket 的方式是双向的，客户端和服务器建立连接后能多次交互。

- 应用场景 1.实时性要求高的应用，如在线聊天、游戏、数据可视化 2.频繁交换数据，如在线编辑器、文件管理器 3.推送服务，如实时数据监控、通知系统

![SSE](/qian/websocket.png)

## JWT(鉴权)

[小满 zs-jwt 鉴权](https://juejin.cn/post/7248531609388204090?searchId=20251202093803243B413F4B802CD2A132)

主要是做鉴权用的登录之后存储用户信息，如生成的 token(令牌)
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjg3Njc0NDkyLCJleHAiOjE2ODc3NjA4OTJ9.Y6eFGv4KXqUhlRHglGCESvcJEnyMkMwM1WfICt8xYC4

由三部分组成头部（Header）、负载（Payload）、签名（Signature）

```js
app.post("/api/login", (req, res) => {
  // 1. 校验请求参数（非空）
  if (!req.body.name || !req.body.password) {
    return res.json({ message: "参数不能为空", code: 400 });
  }
  // 2. 验证用户身份（数据库/模拟数据校验）
  if (req.body.name === user.name && req.body.password === user.password) {
    // 3. 生成 Token：jwt.sign(有效载荷, 密钥, 配置项)
    const token = jwt.sign(
      { id: user.id }, // 有效载荷：存储非敏感用户信息（避免存密码）
      secretKey,       // 加密密钥
      { expiresIn: 60 * 60 * 24 } // 过期时间：24小时（支持秒数/字符串如"1d"）
    );
    // 4. 返回 Token 给前端
    res.json({ code: 200, message: "登录成功", token });
  } else {
    res.json({ code: 400, message: "用户名/密码错误" });
  }
});
```
