---
title: ç½‘ç»œè¯·æ±‚æ–¹æ³•ajaxã€fetchã€axios
date: 2025-11-28 17:58:41
permalink: /qianduan/net
categories:
  - å‰ç«¯
  - javascript
tags:
  - javascript
---

> - å‚è€ƒå†…å®¹
>   [Ajaxã€Fetchã€Axios ä¸‰è€…çš„åŒºåˆ«](https://juejin.cn/post/7086325194934976519)

::: details ğŸ’¡ å†…å®¹å¤§çº²

ä¸»è¦å†…å®¹åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†

- ç½‘ç»œè¯·æ±‚ ajax
- ç½‘ç»œè¯·æ±‚ Fetch API
- axios
- ç»„ä»¶ä¸­ä½¿ç”¨ç»“åˆ async/await
  **ç›®æ ‡:äº†è§£å¦‚ä½•ä»æœåŠ¡å™¨è·å–æ•°æ®å¹¶ä½¿ç”¨å®ƒæ¥æ›´æ–°ç½‘é¡µå†…å®¹ã€‚**
  :::

![](/qian/ç½‘ç»œè¯·æ±‚.png)

## Ajax

å…¨ç§°æ˜¯ï¼šAsynchronous JavaScript And XMLï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œå¼‚æ­¥çš„ Javascript å’Œ XMLâ€ã€‚

- **ç‰¹ç‚¹ï¼šå±€éƒ¨åˆ·æ–°é¡µé¢ï¼Œæ— éœ€é‡è½½æ•´ä¸ªé¡µé¢ã€‚**

```js
//åˆ©ç”¨XMLHttpRequestæ¨¡å—å®ç°äº†ä¸€ä¸ªæœ€ç®€å•çš„getç½‘ç»œè¯·æ±‚
function ajax(url) {
  const xhr = new XMLHttpRequest();
  //openæ–¹æ³•çš„ä¸‰ä¸ªå‚æ•°ï¼šè¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚åœ°å€ï¼Œæ˜¯å¦å¼‚æ­¥ï¼›é»˜è®¤æ˜¯å¼‚æ­¥æ“ä½œ
  xhr.open("get", url, true);
  xhr.onreadystatechange = function () {
    // å¼‚æ­¥å›è°ƒå‡½æ•°
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        console.info("å“åº”ç»“æœ", JSON.parse(xhr.response).data);
      }
    }
  };
  xhr.send(null);
}
ajax("http://localhost:3000/api/get-data?name=age=20");
```

## Fetch API

Fetch æ˜¯åœ¨ ES6 å‡ºç°çš„ï¼Œå®ƒä½¿ç”¨äº† ES6 æå‡ºçš„ promise å¯¹è±¡ã€‚å®ƒæ˜¯ XMLHttpRequest çš„æ›¿ä»£å“ã€‚

> æŠŠå®ƒä¸ Ajax ä½œæ¯”è¾ƒï¼Œå…¶å®è¿™æ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ Ajax æ˜¯æŒ‡ä½¿ç”¨ XMLHttpRequest å®ç°çš„ Ajaxï¼Œæ‰€ä»¥çœŸæ­£åº”è¯¥å’Œ XMLHttpRequest ä½œæ¯”è¾ƒã€‚

- **ç‰¹ç‚¹ï¼š**
  - ä½¿ç”¨ promiseï¼Œä¸ä½¿ç”¨å›è°ƒå‡½æ•°
  - é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯”å¦‚ repã€res ç­‰å¯¹è±¡åˆ†æ•£å¼€æ¥ï¼Œæ¯”è¾ƒå‹å¥½ã€‚
  - é€šè¿‡æ•°æ®æµå¯¹è±¡å¤„ç†æ•°æ®ï¼Œå¯ä»¥æé«˜ç½‘ç«™æ€§èƒ½ã€‚

```js
<script>
  //é‡‡ç”¨promiseä¸­çš„.thené“¾å¼è°ƒç”¨çš„æ–¹æ³•å¤„ç†ç»“æœ function Fetch(url){" "}
  {fetch(url)
    .then((res) => res.json())
    .then((data) => {
      console.info(data);
    })}
  Fetch('https://smallpig.site/api/categorygetCategory')
</script>
```

## axios

`Axios`æ˜¯ä¸€ä¸ªåŸºäº`promise`å°è£…çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œå®ƒæ˜¯åŸºäº XHR è¿›è¡ŒäºŒæ¬¡å°è£…ã€‚

- **ç‰¹ç‚¹:**
  - æ”¯æŒ Promise API
  - æ‹¦æˆªè¯·æ±‚å’Œå“åº”
  - è½¬æ¢è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®
  - è‡ªåŠ¨è½¬æ¢ JSON æ•°æ®
  - å®¢æˆ·ç«¯æ”¯æŒé˜²å¾¡ XSRF
  - æ”¯æŒ async/await ç”¨æ³•

```js
// å‘é€ POST è¯·æ±‚
axios({
  method: "post",
  url: "/user/12345",
  data: {
    firstName: "Fred",
    lastName: "Flintstone",
  },
});
```

## ä½¿ç”¨ axios å®ç°è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨

**é¦–å…ˆè¦æ˜ç¡® axios ä¸ºä»€ä¹ˆè¦è¿›è¡Œå°è£…ï¼Ÿ**
è™½ç„¶é»˜è®¤ç›´æ¥å¯¼å…¥å¹¶ä½¿ç”¨ axiosï¼Œé€šè¿‡é»˜è®¤çš„ getã€post æ–¹æ³•ä¹Ÿèƒ½å®Œæˆæ•°æ®è¯·æ±‚ã€‚ä½†æ˜¯ä¸ºäº†é¿å…é‡å¤ä¹¦å†™è¯·æ±‚åœ°å€ï¼Œä»¥åŠè¯·æ±‚å‰çš„éªŒè¯å’Œè¯·æ±‚åçš„æ“ä½œã€‚é€šè¿‡å¯¹ axios è¿›è¡Œå°è£…ï¼Œæ¥å‡å°‘ä»£ç çš„å®¹æ˜“ã€‚

- **ç›®çš„**
  - é»˜è®¤é…ç½®çš„ç»Ÿä¸€ï¼Œå¦‚åŸºåœ°å€ã€å“åº”æ—¶é—´ã€è¯·æ±‚å¤´
  - å®ç°è¯·æ±‚æ‹¦æˆª
  - å®ç°å“åº”æ‹¦æˆª
  - å¸¸è§é”™è¯¯ä¿¡æ¯å¤„ç†
  - api é›†ä¸­å¼ç®¡ç†

:::tip ğŸ’¡ å°è£…æ“ä½œ 1.åˆå§‹åŒ– axios å®ä¾‹ 2.è®¾ç½®è¯·æ±‚æ‹¦æˆª 3.è®¾ç½®å“åº”æ‹¦æˆª 4.é›†ä¸­ç®¡ç†æ¥å£
:::

### 1.åˆå§‹åŒ– axios å®ä¾‹

ä¸»è¦æ“ä½œï¼šé…ç½®åŸºåœ°å€ï¼Œè¯·æ±‚è¶…æ—¶ï¼Œè¯·æ±‚å¤´ç­‰

```js
const request = axios.create({
  baseURL: "http://pcapi-xiaotuxian-front-devtest.itheima.net",
  timeout: 5000, // è¯·æ±‚è¶…æ—¶æ—¶é—´
  headers: {
    "Content-Type": "application/json",
  },
  withCredentials: false, // è·¨åŸŸè¯·æ±‚æ˜¯å¦éœ€è¦æºå¸¦ cookie
});
```

### 2.è®¾ç½®è¯·æ±‚æ‹¦æˆª

è¯·æ±‚æ‹¦æˆªå™¨ç”¨äºå¤„ç†è¯·æ±‚ï¼Œå¹¶å¯ä»¥åœ¨è¯·æ±‚å‘é€ä¹‹å‰è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚æ·»åŠ è®¤è¯å¤´æˆ– token è®¤è¯ï¼Œæˆ–è€…å–æ¶ˆè¯·æ±‚ã€‚**è¯·æ±‚æ‹¦æˆªåˆ†ä¸ºè¯·æ±‚æˆåŠŸ config ä¸è¯·æ±‚å¤±è´¥ error**ã€‚

```js
request.interceptors.request.use(
  (config) => {
    // å‡è®¾ Token å­˜åœ¨ localStorage ä¸­
    const token = localStorage.getItem("token");
    if (token) {
      // æŒ‰ç…§åç«¯è¦æ±‚ï¼Œå°†Tokenæ·»åŠ åˆ° Headerä¸­(é€šå¸¸æ˜¯ Authorization)
      config.headers["Authorization"] = `Bearer ${token}`;
    }
    console.log("è¯·æ±‚é…ç½®", config);
  },
  (error) => {
    Promise.reject(error);
  }
);
```

### 3.è®¾ç½®å“åº”æ‹¦æˆª

axios è¯·æ±‚çš„è¿”å›ç»“æœé‡Œé¢åŒ…å«äº†å¾ˆå¤šä¸œè¥¿ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡å±‚é¢é€šå¸¸åªéœ€è¦åç«¯è¿”å›çš„æ•°æ®å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®¾ç½®ç›¸åº”æ‹¦æˆªï¼Œåœ¨å“åº”ç»“æœè¿”å›ç»™ä¸šåŠ¡å±‚ä¹‹å‰åšä¸€äº›æ“ä½œã€‚å¦‚ç»Ÿä¸€å¤„ç†é”™è¯¯ç ç­‰ã€‚å“åº”æ‹¦æˆªä¸€èˆ¬æ˜¯**æ¥å£è¿”å›åï¼Œç»Ÿä¸€å¤„ç†ç»“æœï¼ˆè§£æ„æ•°æ®ã€å¤„ç†é”™è¯¯ç ï¼‰**ã€‚

```js
request.interceptors.response.use(
  (response) => {
    const res = response.data;
    if (res.code !== 200) {
      ElMessage.error(res.msg || "ç³»ç»Ÿé”™è¯¯");
      // ç‰¹æ®Šé”™è¯¯ç å¤„ç†ï¼šæ¯”å¦‚ 401 token å¤±æ•ˆ
      if (res.code === 401) {
        // æ¸…é™¤è¿‡æœŸ Token
        localStorage.removeItem("token");
        // è·³è½¬å›ç™»å½•é¡µ (å¯ä»¥ä½¿ç”¨ Vue Router)
        // window.location.href = '/login'
        ElMessage.warning("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•");
      }
      return Promise.reject(new Error(res.msg || "Error"));
    }
    //è¿”å›resæˆ–è€…res.data
    console.log("è¯·æ±‚é…ç½®", res);
  },
  (error) => {
    // å¤„ç† HTTP ç½‘ç»œé”™è¯¯ (å¦‚ 404, 500, ç½‘ç»œæ–­å¼€)
    let message = "";
    const status = error.response ? error.response.status : 0;
    switch (status) {
      case 400:
        message = "è¯·æ±‚å‚æ•°é”™è¯¯";
        break;
      case 401:
        message = "æœªæˆæƒï¼Œè¯·ç™»å½•";
        break;
      case 403:
        message = "æ‹’ç»è®¿é—®";
        break;
      case 404:
        message = "è¯·æ±‚åœ°å€å‡ºé”™";
        break;
      case 408:
        message = "è¯·æ±‚è¶…æ—¶";
        break;
      case 500:
        message = "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯";
        break;
      case 502:
        message = "ç½‘å…³é”™è¯¯";
        break;
      case 503:
        message = "æœåŠ¡ä¸å¯ç”¨";
        break;
      default:
        message = "ç½‘ç»œè¿æ¥æ•…éšœ";
        break;
    }
    ElMessage.error(message);
    return Promise.reject(error);
  }
);

//å¯¼å‡ºå®ä¾‹
export default request;
```

### 4.é›†ä¸­ç®¡ç†æ¥å£

ä¸ºäº†æ–¹ä¾¿ç®¡ç†æ•°æ®è¯·æ±‚ï¼Œå‡å°‘ä¸šåŠ¡ä»£ç é‡ï¼Œå°†æ•°æ®æ¥å£è¿›è¡Œé›†ä¸­ç®¡ç†ã€‚

```js
import request from "@/utils/request";

// ç™»å½•æ¥å£
export function login(data) {
  return request({
    url: "/user/login",
    method: "post",
    data, // post è¯·æ±‚ä½“
  });
}

// è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£
export function getUserInfo(id) {
  return request({
    url: "/user/info",
    method: "get",
    params: { id }, // get å‚æ•° (ä¼šè‡ªåŠ¨æ‹¼æ¥æˆ url?id=xxx)
  });
}
```

## é¢è¯•é—®é¢˜
